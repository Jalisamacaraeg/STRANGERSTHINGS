(this["webpackJsonpreact-strangers-things"]=this["webpackJsonpreact-strangers-things"]||[]).push([[0],{18:function(e,t,s){},51:function(e,t,s){"use strict";s.r(t);var r=s(0),n=s(21),c=s.n(n),a=s(9),i=s(7),o=s(3),l=s.n(o),d=s(8),u=s(5),j=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,r,n,c,a,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.url,r=t.method,n=t.token,c=t.body,e.prev=1,a={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)},n&&(a.headers.Authorization="Bearer ".concat(n)),e.next=6,fetch("https://strangers-things.herokuapp.com/api/2010-USD-RM-WEB-PT"+s,a);case 6:return i=e.sent,e.next=9,i.json();case 9:if(!(o=e.sent).error){e.next=12;break}throw o.error;case 12:return e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(1),window.alert("ERROR: ",e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),p=(s(18),s(1)),b=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({url:"/users/me",token:t});case 2:return s=e.sent,r=s.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({url:"/posts"});case 2:return t=e.sent,s=t.data.posts,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),s=t[0],n=t[1],c=Object(r.useState)({}),a=Object(i.a)(c,2),o=a[0],j=a[1],x=Object(r.useState)([]),O=Object(i.a)(x,2),g=O[0],y=O[1];return Object(r.useEffect)(Object(d.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:if(t=e.sent,y(t),s){e.next=7;break}return n(localStorage.getItem("token")),e.abrupt("return");case 7:return e.next=9,b(s);case 9:(r=e.sent)&&r.username&&j(r);case 11:case"end":return e.stop()}}),e)}))),[s]),Object(p.jsxs)("div",{style:{width:"100vw"},children:[Object(p.jsx)(k,{userData:o,setToken:n,setUserData:j}),Object(p.jsxs)(u.c,{children:[Object(p.jsxs)(u.a,{exact:!0,path:"/",children:[o.username&&Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{className:"helloUser",children:Object(p.jsxs)("h3",{children:["Hello, ",o.username,"!"]})})}),Object(p.jsx)(m,{posts:g})," "]}),Object(p.jsx)(u.a,{path:"/dashboard",children:Object(p.jsx)(C,{token:s,userData:o})}),Object(p.jsx)(u.a,{path:"/reply",children:Object(p.jsx)(D,{token:s})}),Object(p.jsx)(u.a,{exact:!0,path:"/posts/createpost",children:Object(p.jsx)(T,{token:s,posts:g,setPosts:y})}),Object(p.jsx)(u.a,{path:"/posts/:postId",children:Object(p.jsx)(f,{posts:g})}),Object(p.jsx)(u.a,{path:"/login",children:Object(p.jsx)(v,{action:"login",setToken:n,setUserData:j})}),Object(p.jsx)(u.a,{path:"/register",children:Object(p.jsx)(v,{action:"register",setToken:n,setUserData:j})})]})]})},O=s(68),v=function(e){var t=e.action,s=e.setToken,n=(e.setUserData,Object(r.useState)("")),c=Object(i.a)(n,2),o=c[0],b=c[1],h=Object(r.useState)(""),x=Object(i.a)(h,2),v=x[0],m=x[1],f="login"===t,g=f?"Login":"Register",y=f?"Register":"Login",w=f?"register":"login",k=Object(u.f)(),N=function(){var e=Object(d.a)(l.a.mark((function e(r){var n,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,j({url:"/users/".concat(t),body:{user:{username:o,password:v}},method:"POST"});case 3:c=e.sent,(a=null===c||void 0===c||null===(n=c.data)||void 0===n?void 0:n.token)&&(localStorage.setItem("token",a),b(""),m(""),s(a),k.push("/"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"form",children:[Object(p.jsx)("h2",{className:"formTitle",children:g}),Object(p.jsxs)("form",{onSubmit:N,children:[Object(p.jsx)("div",{children:Object(p.jsx)("input",{className:"inputUsername",type:"text",placeholder:"username",required:!0,onChange:function(e){return b(e.target.value)}})}),Object(p.jsx)("div",{children:Object(p.jsx)("input",{className:"inputPassword",type:"password",placeholder:"password",onChange:function(e){return m(e.target.value)}})}),Object(p.jsx)("div",{children:Object(p.jsx)(O.a,{variant:"contained",type:"submit",style:{display:"flex",alignItems:"center",marginTop:"15px",margin:"auto",backgroundColor:"blue",color:"white"},children:g})})]}),Object(p.jsx)(a.b,{className:"switchToLink",to:"/".concat(w),children:y})]})},m=function(e){var t=e.posts,s=Object(u.f)(),n=Object(r.useState)(""),c=Object(i.a)(n,2),a=c[0],o=c[1],l=a.length>0?t.filter((function(e){return function(e,t){for(var s=t.toLowerCase(),r=0,n=[e.description,e.location,e.title,e.author.username];r<n.length;r++)if(n[r].toLowerCase().includes(s))return!0}(e,a)})):t;return Object(p.jsxs)("div",{className:"postsBody",children:[Object(p.jsx)("h2",{className:"postsHeading",children:"Posts"}),Object(p.jsx)("input",{type:"text",placeholder:"Search for posts",style:{padding:".25em",marginBottom:".25em",outline:"1px solid black"},autoFocus:"autoFocus",value:a,onChange:function(e){o(e.target.value)}}),l.length>0?l.map((function(e){return Object(p.jsxs)("div",{style:{borderTop:"1px solid black",padding:".5em"},children:[Object(p.jsx)("h5",{children:e.title}),Object(p.jsxs)("div",{children:["Posted by: ",e.author.username]}),Object(p.jsxs)("div",{children:["Description: ",e.description," "]}),Object(p.jsx)("button",{className:"viewPostsButton",onClick:function(){s.push("/posts/".concat(e._id))},children:"View Post"})]},e._id)})):Object(p.jsx)("h5",{children:" No posts to display"})]})},f=function(e){var t=e.posts,s=Object(u.g)().postId,r=t.find((function(e){return s===e._id}));return Object(p.jsx)("div",{children:r?Object(p.jsxs)("div",{className:"singlePost",children:[Object(p.jsx)("h2",{children:r.title}),Object(p.jsxs)("div",{children:["Posted by: ",r.author.username]}),Object(p.jsxs)("div",{children:["Description: ",r.description," "]}),Object(p.jsxs)("div",{children:["Price: ",r.price]}),Object(p.jsxs)("div",{children:["Location: ",r.location]}),Object(p.jsxs)("div",{children:["Delivers: ",r.willDeliver?"Yes":"No"]})]}):Object(p.jsx)(N,{})})},g=s(66),y=s(67),w=Object(g.a)({toolbar:{display:"flex",justifyContent:"space-between",background:"silver",width:"100vw"}}),k=function(e){var t=e.setToken,s=e.userData,r=e.setUserData,n=w();return Object(p.jsx)("div",{children:Object(p.jsxs)(y.a,{className:n.toolbar,children:[Object(p.jsx)("div",{children:Object(p.jsx)(a.b,{className:"siteName",to:"/",children:"not Craig's List"})}),Object(p.jsx)("div",{children:s._id?Object(p.jsx)("span",{children:Object(p.jsx)(a.b,{className:"createPost",to:"/posts/createpost",children:"Create a post"})}):Object(p.jsx)(p.Fragment,{children:" "})}),Object(p.jsx)("div",{children:s._id?Object(p.jsx)("span",{children:Object(p.jsx)(a.b,{className:"dashboard",to:"/dashboard",children:"Dashboard"})}):Object(p.jsx)(p.Fragment,{children:" "})}),Object(p.jsx)("div",{children:s._id?Object(p.jsx)(a.b,{className:"logOut",to:"/",onClick:function(){return localStorage.clear(),r({}),void t("")},children:"Logout"}):Object(p.jsx)(a.b,{className:"loginRegister",to:"/login",children:"Login / Register"})})]})})},N=function(){return Object(p.jsx)("div",{id:"loading",children:Object(p.jsx)("h2",{className:"message",children:"One moment..."})})},T=function(e){var t=e.token,s=Object(r.useState)(""),n=Object(i.a)(s,2),c=n[0],a=n[1],o=Object(r.useState)(""),b=Object(i.a)(o,2),h=b[0],x=b[1],v=Object(r.useState)(""),m=Object(i.a)(v,2),f=m[0],g=m[1],y=Object(r.useState)(""),w=Object(i.a)(y,2),k=w[0],N=w[1],T=Object(r.useState)(!1),C=Object(i.a)(T,2),D=C[0],S=C[1],P=Object(u.f)(),L=function(){var e=Object(d.a)(l.a.mark((function e(s){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,j({url:"/posts",body:{post:{title:c,description:h,price:f,location:k,deliver:D}},method:"POST",token:t});case 3:r=e.sent,(null===r||void 0===r?void 0:r.success)?(window.alert("Post submitted!"),P.push("/")):window.alert("Post wasn't successful");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"createPostPage",children:[Object(p.jsx)("h2",{className:"createPostTitle",children:"Create Post"}),Object(p.jsxs)("form",{onSubmit:L,children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"titleText",htmlFor:"Title",children:"Title:"}),Object(p.jsx)("input",{className:"title",type:"text",required:!0,onChange:function(e){return a(e.target.value)}})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"descriptionText",htmlFor:"Description",children:"Description:"}),Object(p.jsx)("textarea",{className:"description",type:"text",required:!0,onChange:function(e){return x(e.target.value)}})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"priceText",htmlFor:"Price",children:"Price:"}),Object(p.jsx)("input",{className:"price",type:"number",required:!0,onChange:function(e){return g(e.target.value)}})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"locationText",htmlFor:"Location",children:"Location:"}),Object(p.jsx)("input",{className:"location",type:"text",required:!0,onChange:function(e){return N(e.target.value)}})]}),Object(p.jsx)("div",{className:"willDeliver",children:Object(p.jsxs)("div",{children:["Will Deliver ?"," ",Object(p.jsxs)("select",{value:D,onChange:function(e){S(e.target.value)},children:[Object(p.jsx)("option",{value:!0,children:" -- select an option -- "}),Object(p.jsx)("option",{value:"Yes",children:"Yes"}),Object(p.jsx)("option",{value:"No",children:"No"})]})]})}),Object(p.jsx)("div",{children:Object(p.jsx)(O.a,{type:"submit",style:{display:"flex",marginTop:"15px",marginLeft:"15px",backgroundColor:"blue",color:"white"},children:"Submit"})})]})]})},C=function(e){var t=e.token,s=e.post,r=e.userData,n=r.messages,c=r.posts,a=(Object(u.f)(),function(){var e=Object(d.a)(l.a.mark((function e(r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,j({url:"/posts/".concat(s._id),body:{post:{title:title,description:description,price:price,location:location,deliver:deliver}},method:"PATCH",token:t});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i=function(){var e=Object(d.a)(l.a.mark((function e(s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({url:"/posts",body:{post:{title:title,description:description,price:price,location:location,deliver:deliver}},method:"DELETE",token:t});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(d.a)(l.a.mark((function e(s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({url:"/posts",body:{post:{title:title,description:description,price:price,location:location,deliver:deliver}},method:"POST",token:t});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"dashboardBody",children:[Object(p.jsxs)("h3",{className:"userDashboardTitle",children:[r.username,"'s Dashboard"]}),Object(p.jsx)("h2",{className:"postsHeading",children:"Posts"}),Object(p.jsx)("div",{children:c.map((function(e){return Object(p.jsxs)("div",{style:{borderTop:"1px solid black",padding:".5em"},children:[Object(p.jsx)("h5",{children:e.title}),Object(p.jsxs)("div",{children:["Posted by : ",e.author.username]}),Object(p.jsxs)("div",{children:["Description : ",e.description]}),Object(p.jsxs)("div",{children:["Created at: ",e.createdAt]}),Object(p.jsx)(O.a,{variant:"contained",type:"submit",style:{marginTop:"10px",marginRight:"15px",backgroundColor:"blue",color:"white"},onClick:function(){return a()},children:"Update"}),Object(p.jsx)(O.a,{variant:"contained",type:"submit",style:{marginTop:"10px",marginRight:"15px",backgroundColor:"blue",color:"white"},onClick:function(){return i()},children:"DELETE"})]},e._id)}))}),Object(p.jsx)("h2",{className:"messagesHeading",children:"Messages"}),n.map((function(e){return Object(p.jsxs)("div",{style:{borderTop:"1px solid black",padding:".5em"},children:[Object(p.jsx)("h5",{children:e.fromUser.username}),Object(p.jsxs)("div",{children:["Message:",e.content]}),Object(p.jsxs)("div",{children:["Post: ",e.post.title," "]}),Object(p.jsx)("span",{children:Object(p.jsx)(O.a,{variant:"contained",type:"submit",style:{marginTop:"10px",marginRight:"15px",backgroundColor:"blue",color:"white"},onClick:function(){return o()},children:"Reply"})})]},e._id)}))]})},D=function(e){var t=e.token,s=Object(r.useState)(""),n=Object(i.a)(s,2),c=n[0],a=(n[1],Object(r.useState)("")),o=Object(i.a)(a,2),u=o[0],b=o[1],h=function(){var e=Object(d.a)(l.a.mark((function e(s){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({url:"/posts",body:{post:{title:c,description:u,price:price,location:location,deliver:deliver}},method:"POST",token:t});case 2:r=e.sent,(null===r||void 0===r?void 0:r.success)?(window.alert("Message sent!"),history.push("/dashboard")):window.alert("Message wasn't successful");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"messagesBody",children:[Object(p.jsx)("h2",{className:"messagesTitle",children:"Reply Message"}),Object(p.jsxs)("form",{onSubmit:h,children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"descriptionText",htmlFor:"Description"}),Object(p.jsx)("textarea",{className:"description",type:"text",required:!0,onChange:function(e){return b(e.target.value)}})]}),Object(p.jsx)("div",{children:Object(p.jsx)(O.a,{type:"submit",style:{display:"flex",marginTop:"15px",marginLeft:"15px",backgroundColor:"blue",color:"white"},children:"Reply"})})]})]})};c.a.render(Object(p.jsx)(a.a,{children:Object(p.jsx)(x,{})}),document.querySelector("#app"))}},[[51,1,2]]]);
//# sourceMappingURL=main.a77b0d90.chunk.js.map